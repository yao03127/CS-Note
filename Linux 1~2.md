# Linux 1~2
## Linux 是什麼?
開放原始碼類似Unix作業系統，廣泛運用在伺服器、嵌入式系統。具有可移植性Open Source作業系統，它的程式碼可以被修改適合在各種機器上。運行目前主流的 Linux 發佈版本包括：Debian、Fedora、CentOS、Ubuntu 等
![](https://i.imgur.com/zCj5xmX.jpg)
## Linux 發展與線上升級
Linux的內核版本編號：2.6.32-358.el6.x86_64
(通過命令uname -a可以看到)（主版本.次版本.釋出版本-修改版本）
版本會分為：
1. 開發中版本範例(主、次版本為奇數)：2.5.x
1. 穩定版本範例(主、次版本為偶數)：2.6.x

Linux 開發商有提供『線上升級』機制，透過此機制， 原版光碟就只有第一次安裝時用到，其他時候只要有網路，就能夠取得原開發商所提供的任何軟體

在 dpkg 管理機制上就有開發出 APT 的線上升級機制，RPM 則依開發商的不同，有不同的下載軟體指令模式
![](https://i.imgur.com/wgnuGxa.jpg)
## Linux 檔案系統目錄結構
![](https://i.imgur.com/qKrqFgz.jpg)
### Linux 各目錄存放內容
1. /：根目錄，所有檔案皆從根目錄開始，只有root使用者具該目錄的許可權
1. /root：該目錄為系統管理員，也稱作超級許可權者的使用者主目錄
1. /bin：存放著經常使用的命令
1. /boot：系統啟動時必須讀取的檔案, 包括系統核心
1. /home：存放普通使用者的家目錄，每個使用者都有自己的家目錄
1. /etc：放置與系統設定、管理相關的檔案
1. /usr：非常重要的目錄，使用者的應用程式和檔案都放在這個目錄下，類似與windows下的program files目錄
1. /media：可用來做為光碟、軟碟片、隨身碟與其他分割區的自動掛載點
1. /tmp：供全部使用者暫時放置檔案的目錄
1. /var：系統執行時, 內容經常變動的資料或暫存檔(log file), 都會放置在這個目錄裡
### 檔案命名原則、副檔名
1. 區分英文字元的大小寫，基本以小寫為主
1. 檔名長度至多256個字元，可包括字母、數字、"."(點)、"_"(下劃線)和"-"(連字元)
1. 檔名不可使用的字元："?"(問號),"*"(星號), " "(空格), "$"(貨幣符), "&", "("擴號, "/" (斜線), ".." 
1. .filename，檔名前面有小數點，為隱藏檔
### 絕對/相對路徑的移動
1. 絕對路徑：路徑的寫法『一定由根目錄 / 寫起』ex. /usr/share/doc
2. 相對路徑：路徑的寫法『不是由 / 寫起』，ex. 由 /usr/share/doc 到 /usr/share/man 底下時，寫成： 『cd ../man』，相對路徑意指『相對於目前工作目錄的路徑！』
3. 比較特殊的目錄
> .：此層目錄
> 
> ..：上一層目錄
> 
> "-"：前一個工作目錄
> 
> "~"：『目前使用者身分』所在的家目錄(home)
## 指令
|   指令   |        功能/用途         |
|:--------:|:------------------------:|
|    cd    |         變換目錄         |
|   pwd    | 顯示目前的目錄的所在位置 |
|    ls    |   顯示目錄下的所有檔案   |
|  touch   |         建立檔案         |
|    cp    |           複製           |
|   cat    |       查看檔案內容       |
|    vi    |         編輯檔案         |
|  mkdir   |      建立一個新目錄      |
| mkdir -p |     同時建立多個目錄     |
|  rmdir   | 刪除一個裡面是空的空目錄 |
|    rm    |         刪除檔案         |
|  rm -r   |         強制刪除         |
|    mv    |      移動，重新命名      |
### 查看檔案目錄資訊
* ls -l：顯示目錄下的所有檔案詳細資訊
* ls -al：顯示目錄下的所有檔案(包含隱藏檔)詳細資訊
![](https://i.imgur.com/OeepAII.jpg)
### 更改檔案或目錄權限
* chown可修改檔案或目錄的擁有者及群組
![](https://i.imgur.com/XPb1WmQ.jpg)
### 更改使用者權限
* chmod可控制檔案如何被他人調用
→ chmod [-cfvR] [--help] [--version] mode file…
* mode許可權設定字串 
→ [ugoa...][[+-=][rwxX]...][,...]
![](https://i.imgur.com/SWJNVGM.jpg)
### 目錄權限
* chmod 664 test.txt
![](https://i.imgur.com/7v3YHjD.jpg)
### 更改使用者權限
1. 檔案 file1.txt 設為所有人皆可讀取 :
> * chmod ugo+r file1.txt
> *  chmod ugo+r file1.txt
2. 將檔案 file1.txt 與 file2.txt 設為該檔案擁有者，與其所屬同一個群體者可寫入，但其他以外的人則不可寫入 :
> *  chmod ug+w,o-w file1.txt file2.txt
3. 將 ex1.py 設定為只有該檔案擁有者可以執行 :
> *  chmod u+x ex1.py
4. 將目前目錄下的所有檔案與子目錄皆設為任何人可讀取 :
> *  chmod -R a+r *
5. chmod a=rwx file == chmod 777 file
6. chmod ug=rwx,o=x file ==  chmod 771 file
### 編輯文檔
* nano
1. Ctrl C：顯示游標所在
1. Ctrl W：查詢命令，按下後會跳轉到末行的反白位置，輸入要查詢的內容在按enter及可。
![](https://i.imgur.com/aQtaJ0Z.jpg)
* vi/vim(vim相當於vi的升級版)
1. 一般模式：可使用上下左右進行游標宜動、刪除字元及複製貼上檔案資料。
1. 編輯模式：編輯文字
![](https://i.imgur.com/seUYUV8.jpg)
1. 命令列模式
※！為『強制』的意思
![](https://i.imgur.com/Vkvbo1j.jpg)
### 複製檔案或目錄
1. cp：複製檔案或目錄
1. 指令：cp  -參數  來源檔案   目標檔案
1. 參數：
> * -a：相當於-pdr 的意思
> * -d：若來源檔為連結檔的屬性(link file)，則複製連結檔屬性而非檔案本身
> * -i：如果要複製過去的位置已經有相同檔案，會在覆蓋前詢問是否持續進行
> * -p：將檔案本身屬性(權限、所有者、時間)同時複製過去(一般用於備份居多)
> * -r：針對目錄下檔案做遞歸複製(整個目錄下每一個檔案複製到你想要的位置)
> * -s：複製成符號連結檔(symbolic link)(複製成捷徑檔)
## 使用者與群組
1. 關於身份：
* 身份分類：
> user (owner)		
> group			
> others			
* 群組 (group) 的主要用意：
> 將帳號歸類，有助於類似專案開發
> 每個使用者均可加入多個群組
2. 關於身份類別：
* 系統管理員： root
* 一般帳號：
> 系統帳號 (用於系統帳號的工作)
> 一般使用者帳號 (用於一般使用者登入用)
## 壓縮檔案
* 為什麼要壓縮檔案呢？
> 1. 備份資料的時候，方便整理。
> 1. 將檔案變小，節省電腦硬碟的空間。(但圖片、音訊、視訊等多媒體檔案壓縮率低，並不能有效節省空間)
> 1. 將無數個散亂的檔案打包成一個較小的檔案，亦方便資訊在網路上流通。(可將永久免費版之付費軟體輕鬆分享)
> 1. 壓縮檔案時，可以視情況進行加密。
### 各壓縮的差別
* 考慮的因素
> 1. 壓縮率（compression ratio），能夠將檔案壓到多小。
> 1. 解壓縮所需的時間，也就是需要的 CPU 計算量。
> 1. 解壓縮所需的記憶體空間。
> 1. 相容性（compatibility），即解壓縮程式的普遍性，是不是大部分人都有辦法解壓縮這種格式？
![](https://i.imgur.com/FKA7IoI.jpg)
![](https://i.imgur.com/blB4pzL.jpg)
* 需要在記憶體很小的機器（如小於 128MB）上解壓縮時，則選擇 gzip 格式。
* 需要在很簡單、沒有什麼工具可用的機器解壓縮時，則選擇 gzip 格式。
* 需要節省網路頻寬、縮短下載所需要的時間時，則選擇 xz 格式。
* 需要有最好的壓縮率時，則選擇 tar.xz  格式。
## Linux指令
### 壓縮檔案
* gzip
> 壓縮：gzip FileName

> 解壓縮:
> 1. gunzip FileName.gz
> 1.  gzip -d FileName.gz
* xz
> 壓縮：xz -z FileName
> 
> 解壓縮：xz -d FileName.xz
* tar.gz
> 壓縮：tar -zcvf FileName.tar.gz DirName
> 
> 解壓縮：tar -zxvf FileName.tar.gz
### 檔案搜尋
* find 
> -size EX：找出大於500M的檔案→ -size +500M
> 
> -name EX：找出為照片的檔案→ -name "*.jpg"
> 
> -type EX：-type f→ 一般檔案;  -type d→ 一般目錄
> 
> -user EX：同時找兩個擁有者的檔案→-user user1 -o -user user2
* which filename
>  -a：系統會顯示所有被找到的命令執行檔之完整路徑
>  
> -n<文件名長度>指定文件名長度，指定的長度必須大於或等於所有文件中最長的文件名。
> 
> -p<文件名長度>與-n参數相同，但此處的<文件名長度>包括了文件的路徑。
> -w：指定輸出欄位的寬度。
> 
> -V：顯示版本訊息。
### 檔案內容查閱
* cat  從第一行顯示檔案內容、形成新檔案

cat -n file1 > file2→把file1的檔案內容加上行號後輸入file2檔案
> -n  → 由1開始對所有輸出的行數編號
> 
>  ">"   → 將多個文件覆蓋到目標文件中
>  
>  ">>" → 將多個文件追加到目標文件中，不覆蓋
* tac  從最後一行開始顯示

tac -r -s 'x\|[^x]' test.log→一個接著一個字符的反轉一個文件
> -r→將分隔符作為基礎正規表達是處理
> 
> -s→使用String作為分隔符代替默認的換行符

* more 一頁一頁的顯示檔案內容

more +20 testfile→從第20行開始顯示testfile的文檔內容
> ENTER：向下n行(default為1行)
> Ctrl+F/SPACE：向下滾動一屏
> 
> Ctrl+B：返回上一屏
* less 與 more 類似，顯示檔案室允許用戶既可以向前又可以向後翻頁閱讀檔案

ps -ef |less→ps查看進程信息並通過less分頁顯示	
> j→下一行
> 
> k→上一行
> 
> G→移動到最後一行
> 
> g→移動到第一行
* head 取出前面幾行(預設10行)
> -n：後面接數字，代表幾行的意思
* tail 取出後面幾行(預設10行)
> -n：後面接數字，代表幾行的意思
> 
> -n +20：只想列出20行以後的資料
## 資料傳輸
![](https://i.imgur.com/ZJUJsTM.jpg)
![](https://i.imgur.com/EmMf9f7.jpg)
* Port

> 通訊埠號是 TCP/UDP 與上層通訊的通道，當 TCP/UDP 要傳送訊息時，會指定要由哪一個通訊埠號來接收。一些常用的服務會使用特定的埠號來等待要求的訊息。埠號是由 16 個位元所組成的號碼，0 ~ 255 為保留號碼，256 ~ 65535 則可自行設定。
 
![](https://i.imgur.com/NdkuCit.jpg)
![](https://i.imgur.com/ISSj5PG.jpg)
* TCP/IP
> TCP/IP提供點對點的連結機制，將資料如何封裝、定址、傳輸、路由、在目的地如何接收，加以標準化。它將軟體通信過程抽象化為四個抽象層，採取協議堆疊的方式，分別實作出不同通信協定。協定套組下的各種協議，依其功能不同，被分別歸屬到這四個階層之中，被視為簡化的七層OSI模型
* GET 請求
1. TCP三向交握
在瀏覽器送出請求之後，瀏覽器和伺服器就會開始初步溝通，確定雙方的溝通管道順暢，以便後續請求的執行
1. 瀏覽器請求、資料傳輸、渲染畫面
如同前面所提，當三項交握結束後，瀏覽器和伺服器便會開始執行請求、資料傳輸與渲染畫面的過程
1. TCP四次揮手，結束連線
在網頁成功渲染之後，瀏覽器就會和伺服器進行最後的溝通，確認傳輸過程已完成，準備結束連線
## Linux指令-網路相關
* route
* netstat -r(mac)
> 1. Destination, Genmask：完整的網域
> 1. Gateway：這個網域是從哪個Gateway連接出去的，0.0.0.0表示這個路由是從本機傳送，有IP的話，代表需要經過路由器才能傳出去
> 1. Iface：網路卡介面

![](https://i.imgur.com/ppFUsqt.jpg)
### ping
![](https://i.imgur.com/HKjFrAJ.jpg)
### netstat
> 1. 查看端口是否被占用：netstat -al grep 3306
> 1. 查看數據包統計信息：netstat -s
> 1. 查看路由信息：netstat -r

![](https://i.imgur.com/rwEMl5p.jpg)
![](https://i.imgur.com/xVDL0Sq.jpg)
* 影響網路速度的因素：
> 延遲（Latency）：封包從來源端至目的端中間所花的時間
> 
> 頻寬（Bandwidth）：傳輸媒介的最大吞吐量

* 網路延遲（Latency）的組成元素:
> 1. propagation delay：封包在網路線上傳輸所花費的時間，與網路線上電子訊號跑的速度有關，這個時間就是距離除以訊號傳送速度所得到的數值。
> 1. transmission delay：網路卡將資料傳送到網路線上所花的時間，與網路設備的傳送速度有關。
> 1. nodal processing delay：路由器處理封包表頭、檢查位元資料錯誤與尋找配送路徑等所花費的時間。
> 1. queuing delay：路由器因為某些因素無法立刻將封包傳送到網路上，造成封包暫存在佇列中等待的時間。